<h1>{fromname} Conversation</h1>



<div class="wideleft">

<span class="button low" id="newmsg" style="{buttonstyle}" onClick="hide('newmsg');show('newform')">New Message to {fromname}</span>
<div id="newform" style="{newformstyle}">
<h2>New Message to {fromname}</h2>
<form id="Form" name="Form" action="" method="post"  enctype="multipart/form-data">
<span class="formt">Subject<span class="labelerror">{s2}</span></span>
<input name="subject" type="text" class="formfield {s1}" size="45" value="{subject}"/>
<span class="formt">Message<span class="labelerror">{m2}</span></span>
<textarea rows="6" class="formfield {m1}" name="message" id="message" style="width:100%;resize:vertical;">{textbody}</textarea>
<span class="formt">Add an Image <span class="grey">&middot; up to 1Mb</span><span class="labelerror">{i2}</span></span>
<input type="file" id="file" name="file" size="20" class="formfield {i1}" onchange="toggleRemoveButton()">
  <span id="removeFileButton" style="display: none; margin-left: -20px;color: #ff4a4a;font-weight: bold;padding: 6px;position: absolute;margin-top: -5px;cursor: pointer;
}" onclick="removeFile()">x</span>
<div class="space10"></div>
<input type="submit" class="button" name="button" id="button" value="Send Message"/>
</form>
</div>
<div class="space30"></div>
<h2>Conversation</h2>
{messages}
</div>

<div class="narrowright">
{lastrightad}

</div>
<div class="clear"></div>

<script>
  function removeFile() {
    document.getElementById('file').value = '';
    document.getElementById('removeFileButton').style.display = 'none';
  }

  function toggleRemoveButton() {
    const fileInput = document.getElementById('file');
    const removeButton = document.getElementById('removeFileButton');
    if (fileInput.value) {
      removeButton.style.display = 'inline';
    } else {
      removeButton.style.display = 'none';
    }
  }
</script>
